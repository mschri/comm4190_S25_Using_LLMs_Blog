<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Miranda Schriver">
<meta name="dcterms.date" content="2025-03-25">
<meta name="description" content="Prompting Different LLMs to Solve Various Puzzle Challenges Part 2">

<title>How About Another Puzzle? ‚Äì Experimenting with LLMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c22fc0217bed17bbf278350115fb82f4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Experimenting with LLMs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About Miranda‚Äôs Page</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">How About Another Puzzle?</h1>
                  <div>
        <div class="description">
          Prompting Different LLMs to Solve Various Puzzle Challenges Part 2
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">puzzles</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Miranda Schriver </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 25, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="last-time" class="level2">
<h2 class="anchored" data-anchor-id="last-time">Last Time</h2>
<p>Picking up from where we left off last time, I tried testing LLMs against how well they can fill out a cross word puzzle‚Ä¶and a faulty one at that‚Ä¶the idea was to first see how well an LLM can generate a crossword puzzle‚Äìgiven its renowned talent in mimicing and generating human-like speech, and then in separate chat logs/prompting a second model asking them to evaluate the puzzle itself (knowing that the ‚Äúdown‚Äù clues were not exactly accurately generated).</p>
<p>In sum, the LLM‚Äôs did ok in filling out the puzzle as much as they could given the constraints of the clues and actual solutions. Today, I thought I would extend the experiment to track their learning capacities and see how well they can generate more accurate puzzles over a number of trials. So, within the same, original chat log as the first experiment in which I asked to generate a cross word puzzle, I prompted ChatGPT to do so again and to refine its approach (by letting it know it made a mistake in the first):</p>
</section>
<section id="second-time-around-lets-produce-another-cross-word-puzzle" class="level2">
<h2 class="anchored" data-anchor-id="second-time-around-lets-produce-another-cross-word-puzzle">Second time around, let‚Äôs produce another cross word puzzle:</h2>
<p>I asked Chat to refine it‚Äôs approach with the following prompt:</p>
<blockquote class="blockquote">
<p>‚ÄúThe cross word puzzle you produced above had issues with the‚Äùdown‚Äù clues (they weren‚Äôt real words). Can you produce another similar cross word puzzle or fix the one above?‚Äù</p>
</blockquote>
<section id="chatgpt" class="level3">
<h3 class="anchored" data-anchor-id="chatgpt">ChatGPT:</h3>
<p>You‚Äôre absolutely right ‚Äî the <strong>Down clues and answers in the previous puzzle had inconsistencies</strong> (some weren‚Äôt valid words vertically). Thanks for catching that.</p>
<p>Here is a <strong>new and corrected 5x5 crossword puzzle</strong> ‚Äî all Across and Down entries form valid words.</p>
<hr>
</section>
<section id="crossword-grid-empty-with-numbers" class="level3">
<h3 class="anchored" data-anchor-id="crossword-grid-empty-with-numbers">üß© Crossword Grid (Empty with Numbers)</h3>
<pre><code>1 C A T S _
2 A _ _ _ _
3 R _ _ _ _
4 E _ _ _ _
5 S _ _ _ _</code></pre>
<hr>
</section>
<section id="filled-crossword-grid-solution" class="level3">
<h3 class="anchored" data-anchor-id="filled-crossword-grid-solution">‚úÖ Filled Crossword Grid (Solution)</h3>
<pre><code>1 C A T S Y
2 A R E N A
3 R E A C T
4 E L I T E
5 S T A R S</code></pre>
<hr>
</section>
<section id="clues" class="level3">
<h3 class="anchored" data-anchor-id="clues">Clues</h3>
<p><strong>ACROSS</strong></p>
<ol type="1">
<li>Furry pets that purr.</li>
<li>Stadium or event location.</li>
<li>To respond or reply, especially emotionally.</li>
<li>The best or most skilled.</li>
<li>Bright points in the sky at night.</li>
</ol>
<p><strong>DOWN</strong></p>
<ol type="1">
<li>Careful study or analysis (hint: it‚Äôs also a word in chemistry).</li>
<li>A vocal response (past tense).</li>
<li>Animal companion.</li>
<li>A famous tennis championship city.</li>
<li>Symbol of fame or excellence.</li>
</ol>
<hr>
<blockquote class="blockquote">
<p>The accompanying image it produced:</p>
</blockquote>
<p><img src="img1.png" width="60%"></p>
<ul>
<li>Unfortunately, while this was nice and all‚Äìeven going as far as to produce an image of the crossword‚Äìthis didn‚Äôt exactly accomplish what we wanted, which was a proper, consistent crossword puzzle.</li>
</ul>
<p>Trying one more time, I‚Äôll note the fact that it contains inconsistencies again and will ask it to produce another, hopefully more accurate puzzle</p>
</section>
<section id="third-times-the-charm" class="level3">
<h3 class="anchored" data-anchor-id="third-times-the-charm">Third Time‚Äôs the Charm????</h3>
<p>Absolutely ‚Äî let‚Äôs fix that! Here‚Äôs a <strong>new, clean, and fully consistent 5x5 crossword puzzle</strong> with real English words in every Across and Down slot.</p>
<hr>
</section>
<section id="filled-crossword-grid-solution-1" class="level3">
<h3 class="anchored" data-anchor-id="filled-crossword-grid-solution-1">‚úÖ Filled Crossword Grid (Solution)</h3>
<pre><code>1 P I A N O
2 A R E A S
3 R A I S E
4 I N C E N
5 S E N S E</code></pre>
<hr>
</section>
<section id="crossword-grid-empty-for-solving" class="level3">
<h3 class="anchored" data-anchor-id="crossword-grid-empty-for-solving">üß© Crossword Grid (Empty for Solving)</h3>
<pre><code>1 _ _ _ _ _
2 _ _ _ _ _
3 _ _ _ _ _
4 _ _ _ _ _
5 _ _ _ _ _</code></pre>
<hr>
</section>
<section id="clues-1" class="level3">
<h3 class="anchored" data-anchor-id="clues-1">Clues</h3>
<p><strong>ACROSS</strong></p>
<ol type="1">
<li>A keyboard instrument.</li>
<li>Regions or spaces.</li>
<li>To lift up.</li>
<li>__ burner (type of lab equipment).</li>
<li>Smell, taste, or touch ‚Äî one of five.</li>
</ol>
<p><strong>DOWN</strong></p>
<ol type="1">
<li>Opposite of push.</li>
<li>Sun‚Äôs opposite in weather.</li>
<li>Acknowledge with a nod, for example.</li>
<li>Belonging to us.</li>
<li>Detect or perceive.</li>
</ol>
<hr>
<p><strong>Aaaand</strong>, it still failed‚Ä¶to refer back to some of our prompting strategies from a previous blog post, I tried refining my own approach by inputting an example and seeing how well it does with an already established crossword.</p>
</section>
<section id="the-example" class="level3">
<h3 class="anchored" data-anchor-id="the-example">The example:</h3>
<p>This one should be simple enough, let‚Äôs see how well Chat does in solving it completely and accurately.</p>
<p><img src="img2.png" width="60%"></p>
</section>
<section id="the-answer" class="level3">
<h3 class="anchored" data-anchor-id="the-answer">The Answer:</h3>
<p>Great! Let‚Äôs solve the crossword based on the clues and the layout from your image.</p>
<hr>
</section>
<section id="clues-and-solutions" class="level3">
<h3 class="anchored" data-anchor-id="clues-and-solutions">üß© Clues and Solutions</h3>
<p><strong>ACROSS</strong></p>
<ul>
<li><strong>2. A feline furry animal</strong> ‚Üí <strong>CAT</strong></li>
<li><strong>4. The ability to understand and share the feelings of another</strong> ‚Üí <strong>EMPATHY</strong></li>
<li><strong>5. A small brown bird known for chirping</strong> ‚Üí <strong>SPARROW</strong></li>
</ul>
<p><strong>DOWN</strong></p>
<ul>
<li><strong>1. A large, four-legged animal that is often used for transportation</strong> ‚Üí <strong>HORSE</strong></li>
<li><strong>3. Existing or available in large quantities</strong> ‚Üí <strong>ABUNDANT</strong></li>
</ul>
<hr>
</section>
<section id="filled-in-crossword" class="level3">
<h3 class="anchored" data-anchor-id="filled-in-crossword">‚úÖ Filled-in Crossword</h3>
<p>Here‚Äôs how the crossword fills in (matching the image‚Äôs layout):</p>
<ul>
<li><p><strong>1 Down</strong>: H O R S E</p></li>
<li><p><strong>2 Across</strong>: C A T</p></li>
<li><p><strong>3 Down</strong>: A B U N D A N T</p></li>
<li><p><strong>4 Across</strong>: E M P A T H Y</p></li>
<li><p><strong>5 Across</strong>: S P A R R O W</p></li>
</ul>
<hr>
<p>Let me know if you‚Äôd like this filled-in version as an image!</p>
<p><img src="img3.jpg" width="60%"></p>
<p><img src="img3.jpg" width="60%"></p>
<blockquote class="blockquote">
<p>Perfect!! It solves with style and grace‚Ä¶</p>
</blockquote>
<p>I‚Äôll now ask Chat to create a puzzle of a similar vein, and see how well it truly refines its approach. Hopefully by giving it a reference point, it learns more quickly the kind of output I desire in this case‚Ä¶</p>
</section>
<section id="fourth-time-the-generated-image-is-as-follows" class="level3">
<h3 class="anchored" data-anchor-id="fourth-time-the-generated-image-is-as-follows">Fourth Time: The Generated Image is as follows:</h3>
<p><img src="img4.png" width="60%"></p>
<p><strong><em>OK!</em></strong> Good start! It actually generated a more neat version of a cross word puzzle, let‚Äôs see what the answers are!</p>
<p><img src="img6.png" width="80%"></p>
<p>So, it failed to give a precise answer, unfortunately. According to the clues and answers it gave, the following cross word would be filled out as such:</p>
<p><img src="img5.png" width="60%"></p>
<ul>
<li><p>It‚Äôs interesting to see how poorly LLMs can execute generating cross words correctly. While they excel at pattern matching and semantic relationships, the visual component makes it harder for them to identify various types of word play in these cases. <strong>Further‚Ä¶</strong>: while they can get away with generating sometimes plausible answers, they maintain limitations in their understanding of length constraints, and more niche forms of knowledge required to understand certain clues embedded in colloquial or culturally significant words. In other words, the visually complicated element coupled with the difficulting in extracting definitions makes it hard for LLMs to compete in this realm.</p>
<blockquote class="blockquote">
<p>In sum, stick to solving your cross word puzzles on your own! Trust yourself and the answers you come up with, because in the majority of instances, LLMs will do a much poorer job than you!</p>
</blockquote></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mschri\.github\.io\/comm4190_S25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>